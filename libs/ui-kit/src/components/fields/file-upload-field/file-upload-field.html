<app-form-field-shell [label]="label()" [required]="required()" [errorMessage]="computedErrorMessage()" [hint]="hint()">
  <div class="file-upload-container">
    <input #fileInput type="file" [accept]="accept()" [multiple]="multiple()" (change)="onFileChange($event)"
      class="file-input-hidden" id="file-input" />

    <div class="file-upload-dropzone" [class.drag-over]="isDragOver()" (dragover)="onDragOver($event)"
      (dragleave)="onDragLeave($event)" (drop)="onDrop($event)" (click)="fileInput.click()">
      <div class="upload-icon">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
          <polyline points="17 8 12 3 7 8"></polyline>
          <line x1="12" y1="3" x2="12" y2="15"></line>
        </svg>
      </div>
      <p class="upload-text">{{ placeholder() }}</p>
      <p class="upload-hint">{{ multiple() ? 'Select multiple files' : 'Select a file' }}</p>
    </div>

    @if (selectedFiles().length > 0) {
    <div class="selected-files">
      @for (file of selectedFiles(); track file.name; let i = $index) {
      <div class="file-item">
        <span class="file-icon">{{ getFileIcon(file) }}</span>
        <div class="file-info">
          <span class="file-name">{{ file.name }}</span>
          <span class="file-size">{{ formatFileSize(file.size) }}</span>
        </div>
        <button type="button" class="file-remove" (click)="removeFile(i)" aria-label="Remove file">
          âœ•
        </button>
      </div>
      }
    </div>
    }
  </div>
</app-form-field-shell>