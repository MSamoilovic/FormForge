<div class="form-builder">
  <aside class="sidebar">
    <h3>Available Fields</h3>
    <div
      cdkDropList
      [cdkDropListData]="fields"
      class="field-list"
      [cdkDropListConnectedTo]="['canvasDropList']"
    >
      @for (field of fields; track field) {
        <div class="field-item" cdkDrag [cdkDragData]="field">
          {{ field }}
        </div>
      }
    </div>
  </aside>

  <main
    id="canvasDropList"
    cdkDropList
    class="canvas"
    (cdkDropListDropped)="onDrop($event)"
  >
    <h3>Canvas</h3>
    @for (field of canvasFields; track field.id) {
      <div
        class="canvas-field"
        (click)="selectField(field)"
        [class.selected]="selectedField?.id === field.id"
        role="button"
      >
        <ng-container
          *ngComponentOutlet="
            getComponent(field.type);
            inputs: {
              label: field.label,
              placeholder: field.placeholder,
              options: field.options
            }
          "
        ></ng-container>
      </div>
    }
  </main>

  <aside class="properties" *ngIf="selectedField as field">
    <h3>Properties</h3>

    <label>
      Label:
      <input [(ngModel)]="field.label" />
    </label>


    <label *ngIf="field.type === 'text' || field.type === 'number'">
      Placeholder:
      <input [(ngModel)]="field.placeholder" />
    </label>

    <label>
      Required:
      <input type="checkbox" [(ngModel)]="field.required" />
    </label>

    <div *ngIf="field.type === 'select' || field.type === 'radio'">
      <h4>Options</h4>
      @for (option of field.options; let i = $index; track i) {
        <div class="option-item">
          <input [(ngModel)]="field.options[i]" />
          <button type="button" (click)="removeOption(i)">âœ•</button>
        </div>
      }
      <button type="button" (click)="addOption()">Add Option</button>
    </div>
  </aside>
</div>
