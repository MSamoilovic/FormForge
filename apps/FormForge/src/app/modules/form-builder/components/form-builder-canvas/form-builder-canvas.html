
<mat-card class="canvas-card ff-card-full-height">
  @if (!canvasFields().length) {
    <mat-card-header>
      <mat-card-title class="canvas-title">
        <mat-icon>dashboard_customize</mat-icon>
        <span>Canvas</span>
      </mat-card-title>
      <mat-card-subtitle>Build your form here</mat-card-subtitle>
    </mat-card-header>
  }

  <mat-card-content
    id="canvasDropList"
    cdkDropList
    class="canvas-content"
    [class.has-fields]="canvasFields().length > 0"
    (cdkDropListDropped)="onDrop($event)"
  >
    @if (!canvasFields().length) {
      <div class="empty-state">
        <div class="empty-state-icon">
          <mat-icon>touch_app</mat-icon>
        </div>
        <h3>Start Building Your Form</h3>
        <p>Drag and drop fields from the toolbox to begin</p>
        <div class="empty-state-hint">
          <mat-icon>arrow_back</mat-icon>
          <span>Choose a field type</span>
        </div>
      </div>
    } @else {
      @for (field of canvasFields(); track field.id) {
        <div
          cdkDrag
          class="canvas-field-wrapper"
          (click)="onSelectField(field)"
          [class.selected]="selectedField()?.id === field.id"
        >
          <div class="drag-handle" cdkDragHandle>
            <mat-icon>drag_indicator</mat-icon>
          </div>
          <div class="field-content ff-field-content">
            <ng-container
              [ngComponentOutlet]="getComponent(field.type)"
              [ngComponentOutletInputs]="getComponentInputs(field)"
            ></ng-container>
          </div>
          <div class="field-actions">
            <button
              mat-icon-button
              class="action-button"
              (click)="onDuplicateField(field.id, $event)"
              matTooltip="Duplicate field (Ctrl/Cmd + D)"
              matTooltipPosition="left"
              type="button"
            >
              <mat-icon class="action-icon">content_copy</mat-icon>
            </button>
            <mat-icon class="action-icon">settings</mat-icon>
          </div>
        </div>
      }
    }
  </mat-card-content>
</mat-card>
