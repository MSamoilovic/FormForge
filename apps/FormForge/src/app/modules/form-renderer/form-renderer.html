@if (form) {
  <mat-card class="form-container">
    <mat-card-header>
      <mat-card-title>{{ formSchema.name }}</mat-card-title>
      @if (formSchema.description) {
        <mat-card-subtitle>{{ formSchema.description }}</mat-card-subtitle>
      }
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="form" (ngSubmit)="onSubmit()">

        @for (field of formSchema.fields; track field.id) {
          <div class="field-wrapper">
            <ng-container
              [ngComponentOutlet]="getComponent(field.type)"
              [ngComponentOutletInputs]="getComponentInputs(field)"
            ></ng-container>

            @if (form.get(field.id)?.invalid && form.get(field.id)?.touched) {
              <mat-error class="error-message">
                @for (validation of field.validations; track validation.type) {
                  @if (form.get(field.id)?.hasError(validation.type.toLowerCase())) {
                    {{ validation.message }}
                  }
                }
              </mat-error>
            }
          </div>
        }

        <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid" class="submit-button">
          Submit
        </button>
      </form>
    </mat-card-content>
  </mat-card>
} @else {
  <p>Loading form...</p>
}
